<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG 预览器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Light Mode Default */
            --bg-primary: #ffffff;
            --bg-secondary: #fafafa;
            --bg-tertiary: #f4f4f5;
            --border-color: #e4e4e7;
            --text-primary: #09090b;
            --text-secondary: #71717a;
            --accent: #18181b;
            --accent-hover: #3f3f46;
            --accent-fg: #ffffff;

            /* Checkerboard colors */
            --checker-1: #e4e4e7;
            --checker-2: #ffffff;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #000000;
                --bg-secondary: #09090b;
                --bg-tertiary: #18181b;
                --border-color: #27272a;
                --text-primary: #ffffff;
                --text-secondary: #a1a1aa;
                --accent: #ffffff;
                --accent-hover: #d4d4d8;
                --accent-fg: #000000;

                /* Checkerboard colors */
                --checker-1: #18181b;
                --checker-2: #09090b;
            }
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 32px;
            height: 32px;
            background: var(--accent);
            color: var(--accent-fg);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
            stroke: none;
        }

        h1 {
            font-size: 1.25rem;
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        main {
            flex: 1;
            display: flex;
            gap: 1px;
            background: var(--border-color);
        }

        .panel {
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
        }

        .panel-left {
            width: 400px;
            min-width: 300px;
        }

        .panel-right {
            flex: 1;
            min-width: 400px;
        }

        .panel-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .panel-title {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .panel-content {
            flex: 1;
            padding: 1.5rem;
            overflow: auto;
        }

        /* 拖拽区域 */
        .drop-zone {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            transition: all 0.2s ease;
            cursor: pointer;
            margin-bottom: 1.5rem;
        }

        .drop-zone:hover,
        .drop-zone.dragover {
            border-color: var(--text-primary);
            background: var(--bg-secondary);
        }

        .drop-zone-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 1rem;
            background: var(--bg-tertiary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .drop-zone-icon svg {
            width: 24px;
            height: 24px;
            stroke: var(--text-secondary);
        }

        .drop-zone-text {
            font-size: 0.875rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .drop-zone-hint {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* 代码编辑区 */
        .code-section label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.75rem;
            color: var(--text-secondary);
        }

        textarea {
            width: 100%;
            height: 300px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.8125rem;
            line-height: 1.6;
            color: var(--text-primary);
            resize: vertical;
            transition: border-color 0.2s ease;
        }

        textarea:focus {
            outline: none;
            border-color: var(--text-primary);
        }

        textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.5;
        }

        /* 按钮 */
        .btn-group {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .btn {
            flex: 1;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-primary {
            background: var(--accent);
            color: var(--accent-fg);
        }

        .btn-primary:hover {
            background: var(--accent-hover);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--border-color);
        }

        /* 预览区域 */
        .preview-controls {
            display: flex;
            gap: 0.5rem;
        }

        .control-btn {
            width: 36px;
            height: 36px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .control-btn:hover {
            background: var(--border-color);
        }

        .control-btn.active {
            background: var(--accent);
            border-color: var(--accent);
        }

        .control-btn svg {
            width: 18px;
            height: 18px;
            stroke: var(--text-secondary);
        }

        .control-btn.active svg {
            stroke: var(--accent-fg);
        }

        .preview-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
        }

        .preview-area.checkerboard {
            background-image:
                linear-gradient(45deg, var(--checker-1) 25%, transparent 25%),
                linear-gradient(-45deg, var(--checker-1) 25%, transparent 25%),
                linear-gradient(45deg, transparent 75%, var(--checker-1) 75%),
                linear-gradient(-45deg, transparent 75%, var(--checker-1) 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            background-color: var(--checker-2);
        }

        .preview-area.white-bg {
            background: #ffffff;
        }

        .preview-area.dark-bg {
            background: #000000;
        }

        .svg-container {
            max-width: 100%;
            max-height: 100%;
            padding: 2rem;
            transition: transform 0.2s ease;
        }

        .svg-container svg {
            max-width: 100%;
            max-height: 100%;
            display: block;
        }

        .empty-state {
            text-align: center;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 1rem;
            background: var(--bg-tertiary);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .empty-state-icon svg {
            width: 32px;
            height: 32px;
            stroke: var(--text-secondary);
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 0.875rem;
        }

        /* 缩放控制 */
        .zoom-controls {
            position: absolute;
            bottom: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.25rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 0.25rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .zoom-btn {
            width: 32px;
            height: 32px;
            background: transparent;
            border: none;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .zoom-btn:hover {
            background: var(--bg-tertiary);
        }

        .zoom-btn svg {
            width: 16px;
            height: 16px;
            stroke: var(--text-primary);
        }

        .zoom-level {
            padding: 0 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            min-width: 48px;
            justify-content: center;
        }

        /* 文件信息 */
        .file-info {
            margin-top: 1.5rem;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .file-info-title {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.75rem;
        }

        .file-info-item {
            display: flex;
            justify-content: space-between;
            font-size: 0.8125rem;
            padding: 0.375rem 0;
            border-bottom: 1px solid var(--border-color);
        }

        .file-info-item:last-child {
            border-bottom: none;
        }

        .file-info-label {
            color: var(--text-secondary);
        }

        .file-info-value {
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
        }

        /* 隐藏的文件输入 */
        #fileInput {
            display: none;
        }

        /* 响应式 */
        @media (max-width: 900px) {
            main {
                flex-direction: column;
            }

            .panel-left {
                width: 100%;
                max-height: 50vh;
            }

            .panel-right {
                min-height: 50vh;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="logo">
            <svg viewBox="0 0 24 24" fill="none" class="w-6 h-6">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" />
            </svg>
        </div>
        <h1>SVG 预览器</h1>
    </header>

    <main>
        <div class="panel panel-left">
            <div class="panel-header">
                <span class="panel-title">输入</span>
            </div>
            <div class="panel-content">
                <div class="drop-zone" id="dropZone">
                    <div class="drop-zone-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round"
                            stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                    </div>
                    <div class="drop-zone-text">拖拽 SVG 文件</div>
                    <div class="drop-zone-hint">支持点击上传</div>
                </div>
                <input type="file" id="fileInput" accept=".svg">

                <div class="code-section">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                        <label style="margin-bottom: 0;">或粘贴 SVG 代码</label>
                        <button class="btn btn-secondary" onclick="pasteCode()"
                            style="padding: 0.25rem 0.75rem; font-size: 0.75rem; flex: none; width: auto;">
                            粘贴并预览
                        </button>
                    </div>
                    <textarea id="svgCode" placeholder="<svg width=&quot;100&quot; height=&quot;100&quot;>...</svg>"
                        spellcheck="false"></textarea>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="previewFromCode()">预览</button>
                        <button class="btn btn-secondary" onclick="clearAll()">清空</button>
                    </div>
                </div>

                <div class="file-info" id="fileInfo" style="display: none;">
                    <div class="file-info-title">属性</div>
                    <div class="file-info-item">
                        <span class="file-info-label">名称</span>
                        <span class="file-info-value" id="fileName">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label">大小</span>
                        <span class="file-info-value" id="fileSize">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label">视口</span>
                        <span class="file-info-value" id="viewBox">-</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel panel-right">
            <div class="panel-header">
                <span class="panel-title">画布</span>
                <div class="preview-controls">
                    <button class="control-btn active" id="bgCheckerboard" title="透明背景" onclick="setBg('checkerboard')">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7" />
                            <rect x="14" y="3" width="7" height="7" />
                            <rect x="14" y="14" width="7" height="7" />
                            <rect x="3" y="14" width="7" height="7" />
                        </svg>
                    </button>
                    <button class="control-btn" id="bgWhite" title="白色背景" onclick="setBg('white')">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <circle cx="12" cy="12" r="9" />
                        </svg>
                    </button>
                    <button class="control-btn" id="bgDark" title="黑色背景" onclick="setBg('dark')">
                        <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                            <circle cx="12" cy="12" r="9" fill="currentColor" />
                        </svg>
                    </button>
                </div>
            </div>
            <div class="panel-content">
                <div class="preview-area checkerboard" id="previewArea">
                    <div class="empty-state" id="emptyState">
                        <div class="empty-state-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                                <circle cx="8.5" cy="8.5" r="1.5" />
                                <polyline points="21 15 16 10 5 21" />
                            </svg>
                        </div>
                        <div class="empty-state-text">暂无内容</div>
                    </div>
                    <div class="svg-container" id="svgContainer" style="display: none;"></div>
                    <div class="zoom-controls" id="zoomControls" style="display: none;">
                        <button class="zoom-btn" onclick="zoomOut()" title="缩小">
                            <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                <line x1="5" y1="12" x2="19" y2="12" />
                            </svg>
                        </button>
                        <span class="zoom-level" id="zoomLevel">100%</span>
                        <button class="zoom-btn" onclick="zoomIn()" title="放大">
                            <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19" />
                                <line x1="5" y1="12" x2="19" y2="12" />
                            </svg>
                        </button>
                        <button class="zoom-btn" onclick="resetZoom()" title="重置">
                            <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
                                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
                                <path d="M3 3v5h5" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        let currentZoom = 1;
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const svgCode = document.getElementById('svgCode');
        const svgContainer = document.getElementById('svgContainer');
        const emptyState = document.getElementById('emptyState');
        const zoomControls = document.getElementById('zoomControls');
        const previewArea = document.getElementById('previewArea');

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 自动聚焦
            svgCode.focus();
        });

        // 粘贴功能 - 通过聚焦后模拟 Ctrl+V 实现，无需权限
        function pasteCode() {
            svgCode.value = '';  // 清空以便粘贴替换
            svgCode.focus();
            // 使用 execCommand 触发粘贴（依赖用户的粘贴操作上下文）
            const result = document.execCommand('paste');
            if (!result) {
                // 如果 execCommand 失败，提示用户手动按 Ctrl+V
                svgCode.placeholder = '请按 Ctrl+V 粘贴...';
                // 监听一次粘贴事件后自动预览
                const onPaste = () => {
                    setTimeout(() => {
                        if (svgCode.value.includes('<svg')) {
                            previewFromCode();
                        }
                        svgCode.placeholder = '<svg width="100" height="100">...</svg>';
                    }, 50);
                    svgCode.removeEventListener('paste', onPaste);
                };
                svgCode.addEventListener('paste', onPaste);
            } else {
                // execCommand 成功
                setTimeout(() => {
                    if (svgCode.value.includes('<svg')) {
                        previewFromCode();
                    }
                }, 50);
            }
        }

        // 拖拽事件
        dropZone.addEventListener('click', () => fileInput.click());

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) {
                if (file.type === 'image/svg+xml' || file.name.endsWith('.svg')) {
                    loadFile(file);
                } else {
                    alert('请上传 SVG 文件');
                }
            }
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                loadFile(file);
            }
        });

        function loadFile(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const content = e.target.result;
                svgCode.value = content;
                showPreview(content, file.name, file.size);
            };
            reader.readAsText(file);
        }

        function previewFromCode() {
            const code = svgCode.value.trim();
            if (code) {
                showPreview(code);
            }
        }

        function showPreview(svgContent, fileName = null, fileSize = null) {
            // 简单的 SVG 验证
            if (!svgContent.includes('<svg')) {
                alert('内容似乎不是有效的 SVG 代码');
                return;
            }

            try {
                const parser = new DOMParser();
                const doc = parser.parseFromString(svgContent, 'image/svg+xml');
                const svgElement = doc.querySelector('svg');

                if (!svgElement || doc.querySelector('parsererror')) {
                    throw new Error('解析错误');
                }

                svgContainer.innerHTML = svgContent;
                emptyState.style.display = 'none';
                svgContainer.style.display = 'flex';
                zoomControls.style.display = 'flex';
                resetZoom();

                // 更新文件信息
                const fileInfo = document.getElementById('fileInfo');
                if (fileName || fileSize || svgElement.getAttribute('viewBox')) {
                    fileInfo.style.display = 'block';
                    document.getElementById('fileName').textContent = fileName || 'Code Snippet';
                    document.getElementById('fileSize').textContent = fileSize ? formatBytes(fileSize) : formatBytes(new Blob([svgContent]).size);

                    const viewBox = svgElement.getAttribute('viewBox') ||
                        `${svgElement.getAttribute('width') || 'auto'} × ${svgElement.getAttribute('height') || 'auto'}`;
                    document.getElementById('viewBox').textContent = viewBox;
                }
            } catch (e) {
                alert('无法解析 SVG: ' + e.message);
            }
        }

        function clearAll() {
            svgCode.value = '';
            svgContainer.innerHTML = '';
            svgContainer.style.display = 'none';
            emptyState.style.display = 'flex';
            zoomControls.style.display = 'none';
            document.getElementById('fileInfo').style.display = 'none';
            fileInput.value = '';
            // reset background to default if needed, but keeping user preference is usually better
        }

        function setBg(type) {
            previewArea.classList.remove('checkerboard', 'white-bg', 'dark-bg');
            document.querySelectorAll('.control-btn').forEach(btn => btn.classList.remove('active'));

            switch (type) {
                case 'checkerboard':
                    previewArea.classList.add('checkerboard');
                    document.getElementById('bgCheckerboard').classList.add('active');
                    break;
                case 'white':
                    previewArea.classList.add('white-bg');
                    document.getElementById('bgWhite').classList.add('active');
                    break;
                case 'dark':
                    previewArea.classList.add('dark-bg');
                    document.getElementById('bgDark').classList.add('active');
                    break;
            }
        }

        function zoomIn() {
            currentZoom = Math.min(currentZoom + 0.25, 10);
            updateZoom();
        }

        function zoomOut() {
            currentZoom = Math.max(currentZoom - 0.25, 0.1);
            updateZoom();
        }

        function resetZoom() {
            currentZoom = 1;
            updateZoom();
        }

        function updateZoom() {
            svgContainer.style.transform = `scale(${currentZoom})`;
            document.getElementById('zoomLevel').textContent = `${Math.round(currentZoom * 100)}%`;
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        // 支持全局粘贴
        document.addEventListener('paste', (e) => {
            const text = e.clipboardData.getData('text');
            if (text.includes('<svg')) {
                // 如果焦点不在 textarea，则自动填充并预览
                if (document.activeElement !== svgCode) {
                    svgCode.value = text;
                }
                previewFromCode();
            }
        });
    </script>
</body>

</html>